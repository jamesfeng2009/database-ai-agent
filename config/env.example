# SQL 分析器环境变量配置示例

# ========================================
# 数据库配置
# ========================================

# === MySQL 配置 ===
# MySQL 数据库主机地址
MYSQL_HOST=localhost

# MySQL 数据库端口
MYSQL_PORT=3306

# MySQL 数据库用户名
MYSQL_USER=your_mysql_username

# MySQL 数据库密码
MYSQL_PASSWORD=your_mysql_password

# MySQL 数据库名称
MYSQL_DATABASE=your_mysql_database

# === PostgreSQL 配置 ===
# PostgreSQL 数据库主机地址
POSTGRESQL_HOST=localhost

# PostgreSQL 数据库端口
POSTGRESQL_PORT=5432

# PostgreSQL 数据库用户名
POSTGRESQL_USER=your_postgresql_username

# PostgreSQL 数据库密码
POSTGRESQL_PASSWORD=your_postgresql_password

# PostgreSQL 数据库名称
POSTGRESQL_DATABASE=your_postgresql_database

# PostgreSQL SSL 模式 (disable, allow, prefer, require, verify-ca, verify-full)
POSTGRESQL_SSL_MODE=prefer

# ========================================
# 慢查询分析配置
# ========================================

# 查询时间阈值（秒）
SQL_SLOW_THRESHOLD=1.0

# 扫描行数阈值
SQL_ROWS_THRESHOLD=1000

# 限制返回的慢查询数量
SQL_SLOW_LIMIT=5

# 时间范围（小时）
SQL_TIME_RANGE=24

# ========================================
# AI 配置
# ========================================

# === OpenAI API 配置 ===
# OpenAI API 密钥（必填）
OPENAI_API_KEY=your_openai_api_key_here

# 模型名称（可选，默认: deepseek-chat）
OPENAI_MODEL=deepseek-chat

# API 基础 URL（可选，用于自定义端点）
OPENAI_BASE_URL=https://api.deepseek.com

# 请求超时时间，单位秒（可选，默认: 60.0）
OPENAI_TIMEOUT=60.0

# 最大重试次数（可选，默认: 3）
OPENAI_MAX_RETRIES=3

# 是否启用流式响应（可选，默认: false）
OPENAI_STREAM=false

# 是否显示流式响应进度信息（可选，默认: true）
OPENAI_SHOW_STREAMING_PROGRESS=true

# === Ollama API 配置 ===
# Ollama 模型名称（必填）
OLLAMA_MODEL=llama3.2

# Ollama API 基础 URL（可选，默认: http://localhost:11434）
OLLAMA_BASE_URL=http://localhost:11434

# 请求超时时间，单位秒（可选，默认: 60.0）
OLLAMA_TIMEOUT=60.0

# 是否启用流式响应（可选，默认: false）
OLLAMA_STREAM=false

# 是否显示流式响应进度信息（可选，默认: true）
OLLAMA_SHOW_STREAMING_PROGRESS=true

# ========================================
# SQL 分析器通用配置
# ========================================

# 日志级别（可选，默认: INFO）
SQL_ANALYZER_LOG_LEVEL=INFO

# 输出格式（可选，默认: json）可选值: json, text, markdown
SQL_ANALYZER_OUTPUT_FORMAT=json

# 是否启用详细分析（可选，默认: true）
SQL_ANALYZER_ENABLE_DETAILED_ANALYSIS=true

# ========================================
# 使用说明
# ========================================

# 1. 复制此文件为 .env
#    cp config/env.example .env

# 2. 编辑 .env 文件，配置你的数据库连接信息
#    - 如果使用 MySQL，配置 MYSQL_* 相关变量
#    - 如果使用 PostgreSQL，配置 POSTGRESQL_* 相关变量
#    - 可以同时配置两种数据库，程序会自动检测

# 3. 配置 AI 模型（可选）
#    - 推荐使用 Ollama 本地模式（免费、安全）
#    - 或者配置 OpenAI/DeepSeek 云端模式

# 4. 运行程序
#    python app.py

# ========================================
# 数据库准备
# ========================================

# MySQL 准备：
# 1. 确保 MySQL 服务运行
# 2. 开启 performance_schema：
#    SET GLOBAL performance_schema = ON;
# 3. 确保用户有足够权限访问 performance_schema

# PostgreSQL 准备：
# 1. 确保 PostgreSQL 服务运行
# 2. 安装 pg_stat_statements 扩展：
#    CREATE EXTENSION IF NOT EXISTS pg_stat_statements;
# 3. 在 postgresql.conf 中启用统计：
#    shared_preload_libraries = 'pg_stat_statements'
#    pg_stat_statements.track = all
# 4. 重启 PostgreSQL 服务 